suite: UnitTest
description: Testing unit
type: RPC

setup:
  - request:
      method: post
      path: /w/api.php
      parameters:
        action: validatepassword
        format: json
      form-data:
        password: foobar
    response:
      status: 200
      headers:
        content-type: !pcre/pattern: /text/
      body: "{\"validity\":\"Good\"}"

tests:
  - description: Get information about Main Page
    interaction:
      - request:
          method: get
          path: /w/api.php
          parameters:
            action: query
            prop: info
            titles: Main Page
            format: json
          headers:
            accept: application/json
  - description: Get image
    interaction:
      - request:
          method: post
          path: /w/api.php
          form-data:
            action: query
            prop: images
            titles: Main Page
            format: json
          headers:
            content-type: multipart/form-data
            accept: application/json
        response:
          status: 302
          headers:
            content-type: !pcre: /application\/jsons/
          body:
            pages:
              pageid: 143
